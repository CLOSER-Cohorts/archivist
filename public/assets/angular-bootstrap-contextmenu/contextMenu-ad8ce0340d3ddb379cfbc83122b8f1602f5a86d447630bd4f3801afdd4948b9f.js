!function(e,n){n.module("ui.bootstrap.contextMenu",[]).service("CustomService",function(){"use strict";return{initialize:function(e){console.log("got here",e)}}}).constant("ContextMenuEvents",{ContextMenuAllClosed:"context-menu-all-closed",ContextMenuClosed:"context-menu-closed",ContextMenuOpening:"context-menu-opening",ContextMenuOpened:"context-menu-opened"}).directive("contextMenu",["$rootScope","ContextMenuEvents","$parse","$q","CustomService","$sce","$document","$window","$compile",function(t,o,i,l,a,s,r,c,u){function f(t){var o=t.$scope,i=t.item,a=t.event,s=t.modelValue,r=t.$promises,c=t.nestedMenu,f=t.$li,d="left"===String(t.orientation).toLowerCase(),p=null;if(i.html)p=n.isFunction(i.html)?i.html(o):i.compile?u(i.html)(o):i.html;else{var v=e("<a>"),m={};d?(m.textAlign="right",m.paddingLeft="8px"):(m.textAlign="left",m.paddingRight="8px"),v.css(m),v.addClass("dropdown-item"),v.attr({tabindex:"-1",href:"#"});var h=i.text||i[0],g=k;"string"==typeof h?g=h:"function"==typeof h&&(g=h.call(o,o,a,s));var x=l.when(g);r.push(x),x.then(function(n){if(c){var t,o={fontFamily:"monospace",fontWeight:"bold"};d?(t="&lt;",o.float="left"):(t="&gt;",o.float="right");var i=e('<strong style="font-family:monospace;font-weight:bold;float:right;">'+t+"</strong>");i.css(o),v.css("cursor","default"),v.append(i)}v.append(n)}),p=v}return f.append(p),p}function d(e){var t=v(e),o=n.extend({},e),i=e.item,l=i.enabled===undefined?i[2]:i.enabled;o.nestedMenu=t,o.enabled=b(l,e),o.text=f(o),p(o)}function p(t){var o=t.item,i=t.$ul,a=t.$li,s=t.$scope,r=t.modelValue,c=t.level,u=t.event,f=t.text,d=t.nestedMenu,p=t.enabled,v=String(t.orientation).toLowerCase(),h=t.customClass;if(p){var g=function(e){$(c+1);var t={pageX:"left"===v?u.pageX-i[0].offsetWidth+1:u.pageX+i[0].offsetWidth-1,pageY:i[0].offsetTop+a[0].offsetTop-3,view:u.view||window,target:u.target,event:e};l.when(d).then(function(e){n.isFunction(e)&&(e=e.call(s,s,u,r,f,a)),m({$scope:s,event:t,options:e,modelValue:r,level:c+1,orientation:v,customClass:h})})};a.on("click",function(t){1==t.which&&(t.preventDefault(),s.$apply(function(){var t=function(){e(u.currentTarget).removeClass("context"),M()},i=n.isFunction(o.click)?o.click:n.isFunction(o[1])?o[1]:null;if(i){var l=i.call(s,s,u,r,f,a);(l===undefined||l)&&t()}else t()}))}),a.on("mouseover",function(e){s.$apply(function(){d?g(e):$(c+1)})})}else O(a)}function v(e){var t=e.item;return t.children?n.isFunction(t.children)?t.children():n.isFunction(t.children.then)||n.isArray(t.children)?t.children:null:n.isArray(t[1])||t[1]&&n.isFunction(t[1].then)?t[1]:n.isArray(t[2])||t[2]&&n.isFunction(t[2].then)?t[2]:n.isArray(t[3])||t[3]&&n.isFunction(t[3].then)?t[3]:null}function m(i){i.$scope,i.event;var l=i.options,s=(i.modelValue,i.level,i.customClass,g(i));i.$ul=s,A.push(s);var c=[];if(i.$promises=c,n.forEach(l,function(t){if(null===t)F(s);else if(b(t.displayed,i)){var o=e("<li>"),l=n.extend({},i);l.item=t,l.$li=o,"object"==typeof t[0]?a.initialize(o,t):d(l),b(t.hasTopDivider,l,!1)&&F(s),s.append(o),b(t.hasBottomDivider,l,!1)&&F(s)}}),0===s.children().length){var u=n.element("<li>");O(u),u.html("<a>"+E+"</a>"),s.append(u)}r.find("body").append(s),h(i),t.$broadcast(o.ContextMenuOpened,{context:T,contextMenu:s,params:i})}function h(e){var t=e.$ul,o=e.$promises,i=e.level,a=e.event,s="left"===String(e.orientation).toLowerCase();l.all(o).then(function(){var e=a.pageY,o=n.element(t[0]).prop("offsetHeight"),l=c.scrollY+a.view.innerHeight;if(e>o&&l-e<o+20)e=a.pageY-o,i&&i>0&&(e+=a.event.currentTarget.offsetHeight);else if(l<=o)n.element(t[0]).css({height:l-5,"overflow-y":"scroll"}),e=0;else if(l-e<o){var r=5;e<r&&(r=e),e=l-o-r}var u=a.pageX,f=n.element(t[0]).prop("offsetWidth"),d=a.view.innerWidth+window.pageXOffset,p=5;if(s)if(d-u>f&&u<f+p)u=p;else if(u<f){d-u<(v=5)+p&&(v=d-u+p),u=f+v+p}else u-=f;else if(u>f&&d-u-p<f)u=d-f-p;else if(d-u<f){var v;u<(v=5)+p&&(v=u+p),u=d-f-v-p}t.css({display:"block",position:"absolute",left:u+"px",top:e+"px"})})}function g(n){var t=n.customClass,o=e("<ul>");return o.addClass("dropdown-menu"),o.attr({role:"menu"}),o.css({display:"block",position:"absolute",left:n.event.pageX+"px",top:n.event.pageY+"px","z-index":1e4}),t&&o.addClass(t),o}function x(){return"ontouchstart"in window||navigator.maxTouchPoints}function $(e){for(;A.length&&(!e||A.length>e);){var n=A.pop();t.$broadcast(o.ContextMenuClosed,{context:T,contextMenu:n}),n.remove()}e||t.$broadcast(o.ContextMenuAllClosed,{context:T})}function C(e){M(e)}function w(n){for(var t=e(n.target),o=!0;t.length;){if(t.hasClass("dropdown-menu")){o=!1;break}t=t.parent()}o&&M(n)}function M(){r.find("body").off("mousedown",w),r.off("scroll",C),e(T).removeClass("context"),$(),t.$broadcast("")}function y(e){return!1===e||!0===e}function b(e,t,o){t.item;var i=t.$scope,l=t.event,a=t.modelValue;return o=!y(o)||o,y(e)?e:n.isFunction(e)?e.call(i,i,l,a):o}function F(e){var t=n.element("<li>");t.addClass("divider"),e.append(t)}function O(e){e.on("click",function(e){e.preventDefault()}),e.addClass("disabled")}var A=[],T=null,k='"New Item',E="empty";return function(i,a,s){var c=["contextmenu"];E=i.$eval(s.contextMenuEmptyText)||"empty",s.contextMenuOn&&"string"==typeof s.contextMenuOn&&(c=s.contextMenuOn.split(",")),n.forEach(c,function(c){a.on(c.trim(),function(c){if(s.allowEventPropagation||(c.stopPropagation(),c.preventDefault()),x()&&"true"===a.attr("draggable"))return!1;r.find("body").on("mousedown",w),r.on("scroll",C),T=c.currentTarget,e(T).addClass("context"),i.$apply(function(){var e=i.$eval(s.contextMenu),a=s.contextMenuClass,r=i.$eval(s.model),u=s.contextMenuOrientation;l.when(e).then(function(e){n.isFunction(e)&&(e=e.call(i,i,c,r));var l={$scope:i,event:c,options:e,modelValue:r,level:0,customClass:a,orientation:u};t.$broadcast(o.ContextMenuOpening,{context:T}),m(l)})}),i.$on("$destroy",function(){M()})})}),s.closeMenuOn&&i.$on(s.closeMenuOn,function(){M()})}}])}(window.angular.element,window.angular);