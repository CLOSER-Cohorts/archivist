!function(e){e.fn.tipuesearch=function(t){var i=e.extend({show:7,newWindow:!1,showURL:!0,showTitleCount:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!0,highlightEveryTerm:!1,mode:"static",liveDescription:"*",liveContent:"*",contentLocation:"tipuesearch/tipuesearch_content.json",debug:!1},t);return this.each(function(){function t(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function s(t,c){e("#tipue_search_content").hide(),e("#tipue_search_content").html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>'),e("#tipue_search_content").show();var n="",o=!1,p=!1,l=!0,u=0;found=[];var g=e("#tipue_search_input").val().toLowerCase();if(((g=e.trim(g)).match('^"')&&g.match('"$')||g.match("^'")&&g.match("'$"))&&(l=!1),l){var _=g.split(" ");g="";for(var d=0;d<_.length;d++){for(var f=!0,v=0;v<tipuesearch_stop_words.length;v++)_[d]==tipuesearch_stop_words[v]&&(f=!1,p=!0);f&&(g=g+" "+_[d])}_=(g=e.trim(g)).split(" ")}else g=g.substring(1,g.length-1);if(g.length>=i.minimumLength){if(l){if(c){var w=g;for(d=0;d<_.length;d++)for(v=0;v<tipuesearch_replace.words.length;v++)_[d]==tipuesearch_replace.words[v].word&&(g=g.replace(_[d],tipuesearch_replace.words[v].replace_with),o=!0);_=g.split(" ")}var m=g;for(d=0;d<_.length;d++)for(v=0;v<tipuesearch_stem.words.length;v++)_[d]==tipuesearch_stem.words[v].word&&(m=m+" "+tipuesearch_stem.words[v].stem);_=m.split(" ");for(d=0;d<r.pages.length;d++){var x=0,b=r.pages[d].text;for(v=0;v<_.length;v++){var L=new RegExp(_[v],"gi");if(-1!=r.pages[d].title.search(L))x+=20*r.pages[d].title.match(L).length;if(-1!=r.pages[d].text.search(L))x+=20*r.pages[d].text.match(L).length;if(i.highlightTerms){if(i.highlightEveryTerm)var E=new RegExp("("+_[v]+")","gi");else E=new RegExp("("+_[v]+")","i");b=b.replace(E,'<span class="h01">$1</span>')}if(-1!=r.pages[d].tags.search(L))x+=10*r.pages[d].tags.match(L).length;if(-1!=r.pages[d].url.search(L)&&(x+=20),0!=x)for(var R=0;R<tipuesearch_weight.weight.length;R++)r.pages[d].url==tipuesearch_weight.weight[R].url&&(x+=tipuesearch_weight.weight[R].score);_[v].match("^-")&&(L=new RegExp(_[v].substring(1),"i"),-1==r.pages[d].title.search(L)&&-1==r.pages[d].text.search(L)&&-1==r.pages[d].tags.search(L)||(x=0))}0!=x&&(found.push({score:x,title:r.pages[d].title,desc:b,url:r.pages[d].url}),u++)}}else for(d=0;d<r.pages.length;d++){x=0,b=r.pages[d].text,L=new RegExp(g,"gi");if(-1!=r.pages[d].title.search(L))x+=20*r.pages[d].title.match(L).length;if(-1!=r.pages[d].text.search(L))x+=20*r.pages[d].text.match(L).length;if(i.highlightTerms){if(i.highlightEveryTerm)E=new RegExp("("+g+")","gi");else E=new RegExp("("+g+")","i");b=b.replace(E,'<span class="h01">$1</span>')}if(-1!=r.pages[d].tags.search(L))x+=10*r.pages[d].tags.match(L).length;if(-1!=r.pages[d].url.search(L)&&(x+=20),0!=x)for(R=0;R<tipuesearch_weight.weight.length;R++)r.pages[d].url==tipuesearch_weight.weight[R].url&&(x+=tipuesearch_weight.weight[R].score);0!=x&&(found.push({score:x,title:r.pages[d].title,desc:b,url:r.pages[d].url}),u++)}if(0!=u){if(i.showTitleCount&&0==a){var C=document.title;document.title="("+u+") "+C,a++}1==o&&(n+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+g+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+w+"</a></div>"),1==u?n+='<div id="tipue_search_results_count">'+tipuesearch_string_4+"</div>":(c_c=u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),n+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5+"</div>"),found.sort(function(e,t){return t.score-e.score});var T=0;for(d=0;d<found.length;d++){if(T>=t&&T<i.show+t){if(n+='<div class="tipue_search_content_title"><a href="'+found[d].url+'"'+h+">"+found[d].title+"</a></div>",i.debug&&(n+='<div class="tipue_search_content_debug">Score: '+found[d].score+"</div>"),i.showURL){var y=found[d].url.toLowerCase();0==y.indexOf("http://")&&(y=y.slice(7)),n+='<div class="tipue_search_content_url"><a href="'+found[d].url+'"'+h+">"+y+"</a></div>"}if(found[d].desc){var k=found[d].desc,W="",$=k.split(" ");if($.length<i.descriptiveWords)W=k;else for(v=0;v<i.descriptiveWords;v++)W+=$[v]+" ";"."!=(W=e.trim(W)).charAt(W.length-1)&&(W+=" ..."),n+='<div class="tipue_search_content_text">'+W+"</div>"}}T++}if(u>i.show){var j=Math.ceil(u/i.show),O=t/i.show;if(n+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',t>0&&(n+='<li><a class="tipue_search_foot_box" id="'+(t-i.show)+"_"+c+'">'+tipuesearch_string_6+"</a></li>"),O<=2){var S=j;j>3&&(S=3);for(v=0;v<S;v++)n+=v==O?'<li class="current">'+(v+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+v*i.show+"_"+c+'">'+(v+1)+"</a></li>"}else{(S=O+2)>j&&(S=j);for(v=O-1;v<S;v++)n+=v==O?'<li class="current">'+(v+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+v*i.show+"_"+c+'">'+(v+1)+"</a></li>"}O+1!=j&&(n+='<li><a class="tipue_search_foot_box" id="'+(t+i.show)+"_"+c+'">'+tipuesearch_string_7+"</a></li>"),n+="</ul></div>"}}else n+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else p?n+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(n+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",1==i.minimumLength?n+='<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":n+='<div id="tipue_search_warning">'+tipuesearch_string_12+" "+i.minimumLength+" "+tipuesearch_string_13+"</div>");e("#tipue_search_content").hide(),e("#tipue_search_content").html(n),e("#tipue_search_content").slideDown(200),e("#tipue_search_replaced").click(function(){s(0,!1)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id").split("_");s(parseInt(t[0]),t[1])})}var r={pages:[]};e.ajaxSetup({async:!1});var a=0;if("live"==i.mode)for(var c=0;c<tipuesearch_pages.length;c++)e.get(tipuesearch_pages[c]).done(function(t){var s=e(i.liveContent,t).text();s=s.replace(/\s+/g," ");var a=e(i.liveDescription,t).text();a=a.replace(/\s+/g," ");var h=t.toLowerCase().indexOf("<title>"),n=t.toLowerCase().indexOf("</title>",h+7);if(-1!=h&&-1!=n)var o=t.slice(h+7,n);else o=tipuesearch_string_1;r.pages.push({title:o,text:a,tags:s,url:tipuesearch_pages[c]})});"json"==i.mode&&e.getJSON(i.contentLocation).done(function(t){r=e.extend({},t)}),"static"==i.mode&&(r=e.extend({},tipuesearch));var h="";i.newWindow&&(h=' target="_blank"'),t("q")&&(e("#tipue_search_input").val(t("q")),s(0,!0)),e(this).keyup(function(e){"13"==e.keyCode&&s(0,!0)})})}}(jQuery);