/*! angular-base64-upload - v0.1.23
* https://github.com/adonespitogo/angular-base64-upload
* Copyright (c) Adones Pitogo <pitogo.adones@gmail.com> [Sat Aug 05 2017]
* Licensed MIT */

!function(e,n){"use strict";e._arrayBufferToBase64=function(n){for(var t="",a=new Uint8Array(n),i=a.byteLength,r=0;r<i;r+=1)t+=String.fromCharCode(a[r]);return e.btoa(t)},e.angular.module("naif.base64",[]).directive("baseSixtyFourInput",["$window","$q",function(e,t){var a={onChange:"&",onAfterValidate:"&",parser:"&"},i=["onabort","onerror","onloadstart","onloadend","onprogress","onload"];return i.forEach(function(e){a[e]="&"}),{restrict:"A",require:"ngModel",scope:a,link:function(a,r,o,l){function f(e){if(o.maxnum&&o.multiple&&e){var n=e.length<=parseInt(o.maxnum);l.$setValidity("maxnum",n)}return e}function u(e){if(o.minnum&&o.multiple&&e){var n=e.length>=parseInt(o.minnum);l.$setValidity("minnum",n)}return e}function s(e){var n=!0;if(o.maxsize&&e){var t=1e3*parseFloat(o.maxsize);if(o.multiple)for(var a=0;a<e.length;a++){var i=e[a];if(i.filesize>t){n=!1;break}}else n=e.filesize<=t;l.$setValidity("maxsize",n)}return e}function c(e){var n=!0,t=1e3*parseFloat(o.minsize);if(o.minsize&&e){if(o.multiple)for(var a=0;a<e.length;a++){var i=e[a];if(i.filesize<t){n=!1;break}}else n=e.filesize>=t;l.$setValidity("minsize",n)}return e}function p(e){var n,t,a,i=!0;if(o.accept&&(t=o.accept.trim().replace(/[,\s]+/gi,"|").replace(/\./g,"\\.").replace(/\/\*/g,"/.*"),n=new RegExp(t)),o.accept&&e){if(o.multiple)for(var r=0;r<e.length;r++){var f=e[r];if(a="."+f.filename.split(".").pop(),!(i=n.test(f.filetype)||n.test(a)))break}else a="."+e.filename.split(".").pop(),i=n.test(e.filetype)||n.test(a);l.$setValidity("accept",i)}return e}function d(){var e=o.multiple?$:$[0];l.$setViewValue(e),s(e),c(e),f(e),u(e),p(e)}function m(e,n,t,a,i){t[e]=function(e){n()(e,t,a,z,$,i)}}function g(i,r,l){return function(f){var u,s=f.target.result,c=o.maxsize&&r.size>1024*o.maxsize;o.doNotParseIfOversize!==n&&c?l.base64=null:l.base64=e._arrayBufferToBase64(s),u=o.parser?t.when(a.parser()(r,l)):t.when(l),u.then(function(e){$.push(e),r.deferredObj.resolve()}),o.onload&&(a.onload&&"function"==typeof a.onload()?a.onload()(f,i,r,z,$,l):a.onload(f,z))}}function h(e,n,t){for(var r=i.length-1;r>=0;r--){var l=i[r];o[l]&&"onload"!==l&&m(l,a[l],e,n,t)}e.onload=g(e,n,t)}function y(){var n,a=[];for(n=z.length-1;n>=0;n--)z[n].deferredObj=t.defer(),a.push(z[n].deferredObj.promise);for(t.all(a).then(d),n=z.length-1;n>=0;n--){var i=new e.FileReader,r=z[n],o={};o.filetype=r.type,o.filename=r.name,o.filesize=r.size,h(i,r,o),i.readAsArrayBuffer(r)}}function v(e){o.onChange&&(a.onChange&&"function"==typeof a.onChange()?a.onChange()(e,z):a.onChange(e,z))}function V(e){if(o.onAfterValidate){for(var n=[],i=z.length-1;i>=0;i--)n.push(z[i].deferredObj.promise);t.all(n).then(function(){a.onAfterValidate&&"function"==typeof a.onAfterValidate()?a.onAfterValidate()(e,$,z):a.onAfterValidate(e,$,z)})}}var z=[],$=[];l&&(l.$isEmpty=function(e){return!e||(angular.isArray(e)?0===e.length:!e.base64)},a._clearInput=function(){r[0].value=""},a.$watch(function(){return l.$viewValue},function(e){l.$isEmpty(e)&&l.$dirty&&(a._clearInput(),l.$setValidity("maxnum",!0),l.$setValidity("minnum",!0),l.$setValidity("maxsize",!0),l.$setValidity("minsize",!0),l.$setValidity("accept",!0))}),r.on("change",function(e){$=[],$=angular.copy($),0===e.target.files.length?(z=[],d()):(z=e.target.files,y(),v(e),V(e)),o.allowSameFile&&a._clearInput()}))}}}])}(window);
//# sourceMappingURL=angular-base64-upload.min.js.map
;
