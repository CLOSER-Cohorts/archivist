(function(){angular.module("archivist.build").controller("BuildResponseDomainsController",["$controller","$scope","$routeParams","$location","$filter","$timeout","Flash","DataManager","Map","RealTimeListener","RealTimeLocking",function(e,n,s,r,t,o,i,a,u,l,d){return n.load_sidebar=function(){return n.sidebar_objs=t("excludeRDC")(n.instrument.ResponseDomains).sort_by_property()},n.title="Response Domains",n.extra_url_parameters=["response_domains"],n.instrument_options={rds:!0},n["delete"]=function(){var e,r;switch(s.response_domain_type){case"response_domain_texts":r="ResponseDomainText";break;case"response_domain_datetimes":r="ResponseDomainDatetime";break;case"response_domain_numerics":r="ResponseDomainNumeric";break;default:r=!1}if(null!=r&&null!=(e=n.instrument.ResponseDomains.get_index_by_id_and_type(parseInt(s.response_domain_id),r)))return n.instrument.ResponseDomains[e].$delete({},function(){return n.instrument.ResponseDomains.splice(e,1),n.load_sidebar(),o(function(){return n.instrument.ResponseDomains.length>0?n.change_panel(n.instrument.ResponseDomains[0]):n.change_panel({type:r,id:"new"})},0)})},n.save=function(){var e,r,t,o,l;switch(s.response_domain_type){case"response_domain_texts":o="ResponseDomainText";break;case"response_domain_datetimes":o="ResponseDomainDatetime";break;case"response_domain_numerics":o="ResponseDomainNumeric";break;case"new":o="new";break;default:o=!1}if(o){if("new"===o){for(t in l=u.find(a,n.current.type),e=u.find(a.Data,n.current.type),console.log(e),e.push(new l.resource),r=e.length-1,n.current)e[r][t]=n.current[t];e[r].instrument_id=s.id}else r=(e=n.instrument.ResponseDomains).get_index_by_id_and_type(parseInt(s.response_domain_id),o),angular.copy(n.current,e[r]);return e[r].save({},function(e){return e.instrument_id=n.instrument.id,i.add("success","Response Domain updated successfully!"),a.groupResponseDomains(),n.reset(),n.load_sidebar()},function(){return console.log("error")})}},n.reset=function(){var e,r,t,o;if(null!=s.response_domain_type&&null!=s.response_domain_id)for(e=0,r=(o=n.instrument.ResponseDomains).length;e<r;e++)if((t=o[e]).type.pascal_case_to_underscore()+"s"===s.response_domain_type&&t.id.toString()===s.response_domain_id){n.current=angular.copy(t),n.editMode=!1,null!=n.current&&d.unlock({type:n.current.type,id:n.current.id});break}return"new"===s.response_domain_type&&(n.editMode=!0,n.current={}),null},n["new"]=function(){return o(function(){return n.change_panel({type:null,id:"new"})},0),null},n.after_instrument_loaded=function(){return n.load_sidebar()},e("BaseBuildController",{$scope:n,$routeParams:s,$location:r,$timeout:o,Flash:i,DataManager:a,RealTimeListener:l,RealTimeLocking:d})}])}).call(this);