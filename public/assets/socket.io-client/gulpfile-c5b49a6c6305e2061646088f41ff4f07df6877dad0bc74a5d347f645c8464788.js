function testZuul(){const e="./node_modules/zuul/bin/zuul",t=child.spawn(e,[TEST_FILE],{stdio:"inherit"});return t.on("exit",function(e){process.exit(e)}),t}function testNode(){const e={reporter:REPORTER,require:[TEST_SUPPORT_SERVER_FILE],bail:!0};return gulp.src(TEST_FILE,{read:!1}).pipe(mocha(e)).once("error",function(e){console.error(e.stack),process.exit(1)}).once("end",function(){process.exit()})}const gulp=require("gulp"),mocha=require("gulp-mocha"),istanbul=require("gulp-istanbul"),webpack=require("webpack-stream"),child=require("child_process"),help=require("gulp-task-listing"),eslint=require("gulp-eslint");gulp.task("help",help),gulp.task("default",["build"]);const BUILD_TARGET_DIR="./dist/";gulp.task("build",function(){return gulp.src("lib/*.js").pipe(webpack({config:[require("./support/webpack.config.js"),require("./support/webpack.config.dev.js"),require("./support/webpack.config.slim.js"),require("./support/webpack.config.slim.dev.js")]})).pipe(gulp.dest(BUILD_TARGET_DIR))});const REPORTER="dot",TEST_FILE="./test/index.js",TEST_SUPPORT_SERVER_FILE="./test/support/server.js";gulp.task("test",["lint"],function(){return process.env.hasOwnProperty("BROWSERS")?testZuul():testNode()}),gulp.task("test-node",testNode),gulp.task("test-zuul",testZuul),gulp.task("lint",function(){return gulp.src(["*.js","lib/**/*.js","test/**/*.js","support/**/*.js"]).pipe(eslint()).pipe(eslint.format()).pipe(eslint.failAfterError())}),gulp.task("istanbul-pre-test",function(){return gulp.src(["lib/**/*.js"]).pipe(istanbul()).pipe(istanbul.hookRequire())}),gulp.task("test-cov",["istanbul-pre-test"],function(){gulp.src(["test/*.js","test/support/*.js"]).pipe(mocha({reporter:REPORTER})).pipe(istanbul.writeReports()).once("error",function(e){console.error(e),process.exit(1)}).once("end",function(){process.exit()})});