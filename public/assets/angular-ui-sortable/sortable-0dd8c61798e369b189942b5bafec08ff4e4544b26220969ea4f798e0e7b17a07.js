!function(e,t,o){"use strict";t.module("ui.sortable",[]).value("uiSortableConfig",{items:"> [ng-repeat],> [data-ng-repeat],> [x-ng-repeat]"}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,n,i){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"=",create:"&uiSortableCreate",start:"&uiSortableStart",activate:"&uiSortableActivate",beforeStop:"&uiSortableBeforeStop",update:"&uiSortableUpdate",remove:"&uiSortableRemove",receive:"&uiSortableReceive",deactivate:"&uiSortableDeactivate",stop:"&uiSortableStop"},link:function(r,l,a,u){function s(e,t){var o="function"==typeof t;return"function"==typeof e&&o?function(){e.apply(this,arguments),t.apply(this,arguments)}:o?t:e}function c(e){var t=e.data("ui-sortable");return t&&"object"==typeof t&&"ui-sortable"===t.widgetFullName?t:null}function d(e){e.children().each(function(){var e=t.element(this);e.width(e.width())})}function f(e,t){return t}function m(t,o){return H[t]?("stop"===t&&(o=s(o=s(o,function(){r.$apply()}),C)),o=s(H[t],o)):A[t]&&(o=A[t](o)),o||"items"!==t&&"ui-model-items"!==t||(o=e.items),o}function p(e,n,i){function r(e,t){t in U||(U[t]=null)}t.forEach(H,r);var l,a=null;n&&t.forEach(n,function(n,i){if(!(e&&i in e)){if(i in V)return void(U[i]="ui-floating"===i?"auto":m(i,o));l||(l=t.element.ui.sortable().options);var r=l[i];r=m(i,r),a||(a={}),a[i]=r,U[i]=r}});return e=t.extend({},e),t.forEach(e,function(t,o){if(o in V){if("ui-floating"!==o||!1!==t&&!0!==t||!i||(i.floating=t),"ui-preserve-size"===o&&(!1===t||!0===t)){var n=U.helper;e.helper=function(e,t){return!0===U["ui-preserve-size"]&&d(t),(n||f).apply(this,arguments)}}U[o]=m(o,t)}}),t.forEach(e,function(e,t){t in V||(e=m(t,e),a||(a={}),a[t]=e,U[t]=e)}),a}function b(e){var o=e.sortable("option","placeholder");if(o&&o.element&&"function"==typeof o.element){var n=o.element();return n=t.element(n)}return null}function v(e,t){var o=U["ui-model-items"].replace(/[^,]*>/g,"");return e.find('[class="'+t.attr("class")+'"]:not('+o+")")}function g(e,t){var o=e.sortable("option","helper");return"clone"===o||"function"==typeof o&&t.item.sortable.isCustomHelperUsed()}function h(e,t){var o=null;return g(e,t)&&"parent"===e.sortable("option","appendTo")&&(o=M),o}function S(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}function y(e,t){for(var o=0;o<e.length;o++){var n=e[o];if(n.element[0]===t[0])return n}}function C(e,t){t.item.sortable._destroy()}function x(e){return e.parent().find(U["ui-model-items"]).index(e)}function $(){r.$watchCollection("ngModel",function(){n(function(){c(l)&&l.sortable("refresh")},0,!1)}),H.start=function(e,n){if("auto"===U["ui-floating"]){var i=n.item.siblings();c(t.element(e.target)).floating=S(i)}var r=x(n.item);n.item.sortable={model:u.$modelValue[r],index:r,source:l,sourceList:n.item.parent(),sourceModel:u.$modelValue,cancel:function(){n.item.sortable._isCanceled=!0},isCanceled:function(){return n.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!n.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:n.item.sortable._isCustomHelperUsed,_destroy:function(){t.forEach(n.item.sortable,function(e,t){n.item.sortable[t]=o})},_connectedSortables:[],_getElementContext:function(e){return y(this._connectedSortables,e)}}},H.activate=function(e,t){var o=t.item.sortable.source===l,n=o?t.item.sortable.sourceList:l,i={element:l,scope:r,isSourceContext:o,savedNodesOrigin:n};t.item.sortable._connectedSortables.push(i),w=n.contents(),M=t.helper;var a=b(l);if(a&&a.length){var u=v(l,a);w=w.not(u)}},H.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=x(t.item);var o=t.item.parent().closest("[ui-sortable], [data-ui-sortable], [x-ui-sortable]");t.item.sortable.droptarget=o,t.item.sortable.droptargetList=t.item.parent();var n=t.item.sortable._getElementContext(o);t.item.sortable.droptargetModel=n.scope.ngModel,l.sortable("cancel")}var i=!t.item.sortable.received&&h(l,t,w);i&&i.length&&(w=w.not(i));var a=t.item.sortable._getElementContext(l);w.appendTo(a.savedNodesOrigin),t.item.sortable.received&&(w=null),t.item.sortable.received&&!t.item.sortable.isCanceled()&&(r.$apply(function(){u.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)}),r.$emit("ui-sortable:moved",t))},H.stop=function(e,o){var n="dropindex"in o.item.sortable&&!o.item.sortable.isCanceled();if(n&&!o.item.sortable.received)r.$apply(function(){u.$modelValue.splice(o.item.sortable.dropindex,0,u.$modelValue.splice(o.item.sortable.index,1)[0])}),r.$emit("ui-sortable:moved",o);else if(!n&&!t.equals(l.contents().toArray(),w.toArray())){var i=h(l,o,w);i&&i.length&&(w=w.not(i));var a=o.item.sortable._getElementContext(l);w.appendTo(a.savedNodesOrigin)}w=null,M=null},H.receive=function(e,t){t.item.sortable.received=!0},H.remove=function(e,t){"dropindex"in t.item.sortable||(l.sortable("cancel"),t.item.sortable.cancel()),t.item.sortable.isCanceled()||r.$apply(function(){t.item.sortable.moved=u.$modelValue.splice(t.item.sortable.index,1)[0]})},t.forEach(H,function(e,t){H[t]=s(H[t],function(){var e,o=r[t];"function"==typeof o&&("uiSortable"+t.substring(0,1).toUpperCase()+t.substring(1)).length&&"function"==typeof(e=o())&&e.apply(this,arguments)})}),A.helper=function(e){return e&&"function"==typeof e?function(n,i){var r=i.sortable,a=x(i);i.sortable={model:u.$modelValue[a],index:a,source:l,sourceList:i.parent(),sourceModel:u.$modelValue,_restore:function(){t.forEach(i.sortable,function(e,t){i.sortable[t]=o}),i.sortable=r}};var s=e.apply(this,arguments);return i.sortable._restore(),i.sortable._isCustomHelperUsed=i!==s,s}:e},r.$watchCollection("uiSortable",function(e,t){var o=c(l);if(o){var n=p(e,t,o);n&&l.sortable("option",n)}},!0),p(U)}function _(){u?$():i.info("ui.sortable: ngModel not provided!",l),l.sortable(U)}function E(){return(!r.uiSortable||!r.uiSortable.disabled)&&(_(),E.cancelWatcher(),E.cancelWatcher=t.noop,!0)}var w,M,U={},V={"ui-floating":o,"ui-model-items":e.items,"ui-preserve-size":o},H={create:null,start:null,activate:null,beforeStop:null,update:null,remove:null,receive:null,deactivate:null,stop:null},A={helper:null};t.extend(U,V,e,r.uiSortable),t.element.fn&&t.element.fn.jquery?(E.cancelWatcher=t.noop,E()||(E.cancelWatcher=r.$watch("uiSortable.disabled",E))):i.error("ui.sortable: jQuery should be included before AngularJS!")}}}])}(window,window.angular);